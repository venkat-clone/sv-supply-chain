import jwt from "jsonwebtoken";

// Secret key for JWT signing (this should be stored in an environment variable in production)
const JWT_SECRET = process.env.JWT_SECRET || "your-secret-key";

// Function to extract token from request headers
export function getTokenFromHeader(request) {
    const authorization = request.headers.get("Authorization");

    // Check if Authorization header is present and starts with "Bearer "
    if (authorization && authorization.startsWith("Bearer ")) {
        return authorization.split(" ")[1]; // Return the token part of the Bearer token
    }

    return null;
}

// Function to verify and decode the JWT token
export function verifyToken(token) {
    try {
        // Verify the JWT token using the secret key and return the decoded user info
        return jwt.verify(token, JWT_SECRET); // Assuming the token contains user id and email
    } catch (error) {
        console.error("Token verification failed:", error);
        return null;
    }
}
